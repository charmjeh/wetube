## âœ HTMLMediaElement
ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤ë¥¼ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ ([ë¬¸ì„œ](https://developer.mozilla.org/ko/docs/Web/API/HTMLMediaElement))

```javascript
const videoPlayer = document.querySelector("#jsVideoPlayer video");
const playBtn = document.getElementById("jsPlayButton");
const volumBtn = document.getElementById("jsVolumnBtn");

// í•´ë‹¹ media ê°ì²´ê°€ pauseì¸ì§€ ì•„ë‹Œì§€ë¥¼ booleanê°’ìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤. (readonly)
if (HTMLMediaElement.paused) {
    videoPlayer.play(); // ì¬ìƒ
} else {
    videoPlayer.pause(); // ì¼ì‹œì •ì§€
}
// muted : property, ìŒì†Œê±°ì—¬ë¶€ í™•ì¸ ë° read onlyê°€ ì•„ë‹ˆë¯€ë¡œ booleanìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥
if (HTMLMediaElement.muted) {
    videoPlayer.muted = false; // ìŒì†Œê±° í•´ì œ
} else {
    videoPlayer.muted = true; // ìŒì†Œê±°
}

playBtn.addEventListener("click", handlePlayClick);
volumBtn.addEventListener("click", handleVolumeClick);
```

## âœ Element.requestFullscreen()
ë¹„ë””ì˜¤ë¥¼ í’€ìŠ¤í¬ë¦°ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” API


**SYNTAX**
```javascript
var promise = Element.requestFullscreen(options);
```

**MDN EXAMPLE**
```javascript
function toggleFullscreen() {
  let elem = document.querySelector("video");

  if (!document.fullscreenElement) {
    elem.requestFullscreen().catch(err => {
      alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
    });
  } else {
    document.exitFullscreen();
  }
}
```

### ğŸ”¶ It doesn't work on chrome

MDNì˜ compatibilityë¶€ë¶„ì—ì„œ í™•ì¸ ì‹œ `implemented with the vendor prefix: webkit`ì´ë¼ê³  ì í˜€ìˆìœ¼ë©´, í•´ë‹¹ í•¨ìˆ˜ëŠ” `webkit`(í¬ë¡¬)ì—ì„œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ». ì˜ˆë¥¼ ë“¤ì–´, requestFullScreenì€ ë™ì‘í•˜ì§€ ì•ŠìŒ. ê·¸ëŸ¬ë¯€ë¡œ webkitFullScreenìœ¼ë¡œ ì½”ë“œ ë³€ê²½í•˜ì—¬ í•´ê²°
```javascript
videoContainer.webkitRequestFullscreen();
```

## âœ document.exitFullscreen();
ì „ì²´ í™”ë©´ í•´ì œ ('document'ë¼ëŠ”ì ì„ ìœ ì˜)

## âœ INPUT RANGE
`step` : ì´ë™í•˜ëŠ” ë‹¨ìœ„ (`min`ë¶€í„° `max`ê¹Œì§€ ì´ë™ ê°€ëŠ¥)
`value` : ê¸°ë³¸ê°’ì„ ì¤„ìˆ˜ ìˆìŒ.
```html
// videoPlayer.js
input(type="range", min="0", max="1" step="0.1")
```

`videoPlayer.volume`ì€ `mute`í•˜ë”ë¼ë„ ê°’ì„ ê¸°ì–µí•˜ê³  ìˆì–´ì„œ, `videoRange.value`ì˜ ê°’ì„ `0`ìœ¼ë¡œ ì„¤ì •í–ˆë‹¤ê°€ ë‹¤ì‹œ `mute`ë¥¼ í•´ì œí• ë•Œ `videoPlayer.value`ì˜ ê°’ì„ ë„£ì–´ì¤€ë‹¤ë©´ ì›ë˜ ê°’ìœ¼ë¡œ ë³¼ë¥¨ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```javascript
function handleVolumeClick() {
    if (videoPlayer.muted) {
      volumnBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
      videoPlayer.muted = false;
      videoRange.value = videoPlayer.volume;
    } else {
      volumnBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
      videoPlayer.muted = true;
      videoRange.value = 0;
    }
}
```

## âœ MediaDevices

`media devices navigator md`ìœ¼ë¡œ ê²€ìƒ‰ ê°€ëŠ¥  [ë¬¸ì„œì—ì„œ ë³´ê¸°](https://developer.mozilla.org/ko/docs/Web/API/MediaDevices)  
ì¹´ë©”ë¼, ë§ˆì´í¬, ê³µìœ  í™”ë©´ ë“± í˜„ì¬ ì—°ê²°ëœ ë¯¸ë””ì–´ ì…ë ¥ ì¥ì¹˜ë¡œì˜ ì ‘ê·¼ ë°©ë²•ì„ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. ë‹¤ë¥´ê²Œ ë§í•˜ìë©´, ë¯¸ë””ì–´ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ëª¨ë“  í•˜ë“œì›¨ì–´ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

### getUserMedia(configuration object : í™•ì¸ ê°ì²´)
- (*) `getUserMedia(configurationObject)`
  + `configuration object` : ìš”ì²­í•  ê¶Œí•œì„ ëª…ì‹œí•œë‹¤.  
(ì•„ë˜ ì˜ˆì‹œì—ì„œëŠ” audo, video ëª¨ë‘)
  + ì›ë˜ ë¬¸ì„œì—ì„œëŠ” `getUserMedia().then()`ê³¼ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆìœ¼ë‚˜, ì•„ë˜ì™€ ê°™ì´ `try {} catch {}` ë°©ì‹ë„ ì‚¬ìš© ê°€ëŠ¥  
  + (ê°œì¸ì ìœ¼ë¡œ tryë‚´ì—ì„œ awaitë¬¸ ì—¬ëŸ¬ê°œë¥¼ ìˆœì„œëŒ€ë¡œ ì‚¬ìš©í•˜ê³  í•œë²ˆì— catchë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ ê°€ì‹œì„±ì´ ë†’ì•„ ë” ì„ í˜¸í•¨)
  + `video: {width, height}` : ë³´ì—¬ì§€ëŠ” í™”ë©´ì˜ í¬ê¸°ë¥¼ ì¡°ì ˆ ê°€ëŠ¥
- (**) `srcObject` : streamì€ fileì´ ì•„ë‹ˆë¼ Objectì´ë¯€ë¡œ srcë¡œ ì¤„ ìˆ˜ ì—†ìŒ!
```javascript
const getVideo = async () => {
  try {
    await navigator.mediaDevices.getUserMedia({
        audio: true,
        video: { 
            width: 1280,
            height: 720
        }
    }) // (*)
    videoPreview.srcObject = stream; // (**)
  } catch (err) {
    
  }
}
```

```javascript
// mediaë¥¼ userì—ì„œë¶€í„° ì–»ì–´ì™€ì„œ videoì— ë„£ì–´ì•¼í•¨.
const getVideo = async () => {
    try {
        // await : ì‚¬ìš©ìê°€ mediaì— ëŒ€í•œ ì ‘ê·¼ì„ í—ˆìš©í•´ì¤„ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
        // getUserMedia(configuration object : í™•ì¸ ê°ì²´)
        const stream = await navigator.mediaDevices.getUserMedia({
            audio: true,
            video: {
                width: 1280,
                height: 720
            }
        })
        console.log('getVideo', stream)
        
        videoPreview.srcObject = stream;
        streamObject = stream;
        videoPreview.muted = true;
        videoPreview.play();
        recordBtn.innerHTML = 'Stop Recording';
        startRecording();
    } catch (err) {
        // ì‚¬ìš©ìê°€ í—ˆë½í•˜ì§€ ì•Šìœ¼ë©´
        recordBtn.innerHTML = "ğŸ˜¥ Can't record";
    } finally {
        // finally : tryì˜ ì‹¤í–‰ì´ ëë‚œ í›„ ì˜ˆì™¸ ë°œìƒ ì—¬ë¶€ì— ìƒê´€ì—†ì´ ë°˜ë“œì‹œ ì‹¤í–‰ëœë‹¤.
        recordBtn.removeEventListener('click', getVideo)
    }
}
```

## âœ MediaRecorder

media Recoding ê¸°ëŠ¥ ì œê³µ. 
[ë¬¸ì„œì—ì„œ ë³´ê¸°](https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder)

```javascript
  const videoRecorder = new MediaRecorder(streamObject);
  videoRecorder.start();
```

`MediaRecorder`ì—ëŠ” `dataavailable`ê³¼ `ondataavailable`ë¼ëŠ” ë‘ê°€ì§€ ì´ë²¤íŠ¸ê°€ ì¡´ì¬í•˜ëŠ”ë°, ì´ëŠ” í•­ìƒ 2ê°€ì§€ì˜ ìƒì‡„ì‹œí‚¤ëŠ” ì´ë²¤íŠ¸ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

```javascript
  recordBtn.addEventListener('click', getVideo);
  // and also this would works... 
  recordBtn.onclick = getVideo;
```

í•˜ì§€ë§Œ `recordBtn.onclick = getVideo` ë°©ì‹ì€ ë²„íŠ¼ì— **ë‹¨ í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ë§Œ**ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.  
ë˜í•œ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ê¸° ìœ„í•´ì„œëŠ” `recordBtn.onclick = null`ì„ í•  ìˆ˜ ìˆëŠ”ë°, ì´ ë°©ì‹ì€ ëª¨ë“ ê±¸ ì‚­ì œì‹œí‚¤ê¸°ë•Œë¬¸ì— ì—¬ëŸ¬ê°œì˜ ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ `addEventListener` ë°©ì‹ì´ ë” ì‚¬ìš©ì— ìš©ì´í•˜ë‹¤.

**í•´ë‹¹ ë‚´ìš© í…ŒìŠ¤íŠ¸**
```javascript
const RecordBtn = document.getElementById('jsRecordBtn');
// ê¸°ë³¸ ìƒíƒœ : null
console.dir(RecordBtn) // Button#jsRecordBtn > { onclick: null }
RecordBtn.onclick = () => { console.log('ì²«ë²ˆì§¸ ì´ë²¤íŠ¸ì—ìš”'); }
console.log(RecordBtn) // <button id='jsRecordButton'>Stop Recording</button>
console.dir(RecordBtn) // Button#jsRecordBtn > { onclick: () => console.log('ì•ˆë…•í•˜ì„¸ìš”') }
RecordBtn.onclick = () => { console.log('ë‘ë²ˆì§¸ ì´ë²¤íŠ¸ì—ìš”'); }
// ì´ë²¤íŠ¸ê°€ ë®ì–´ì”Œì›Œì§„ê²ƒì„ ì•Œ ìˆ˜ ìˆìŒ
console.dir(RecordBtn) // Button#jsRecordBtn > { onclick: () => console.log('ë‘ë²ˆì§¸ ì´ë²¤íŠ¸ì—ìš”') }
RecordBtn.onclick = null;
console.dir(RecordBtn) // Button#jsRecordBtn > { onclick: null }
```

### dataavailable : Event
mediaRecorderëŠ” ì „ì²´ íŒŒì¼ì„ í•œ ë²ˆì— ì €ì¥í•˜ê²Œ ë˜ì–´ìˆìœ¼ë¯€ë¡œ, recodingì´ ì¢…ë£Œë˜ì—ˆì„ ë•Œ ì „ì²´ íŒŒì¼ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

```javascript
const startRecording = () => {
  const videoRecorder = new MediaRecorder(streamObject);
  videoRecorder.start();
  videoRecorder.addEventListener('dataavailable', handleVideoData)
  setTimeout(() => videoRecorder.stop(), 5000)
  // stop ì‹œ dataavailable ì´ë²¤íŠ¸ê°€ ì‹¤í–‰ë˜ì–´ handleVideoDataì—ì„œ BlobEventë¥¼ ì¤€ë‹¤.
}

const handleVideoData = (event) => {
    console.log(event) // Blob Event
}
```

### start(timeslice: miliseconds ë‹¨ìœ„)

startì— `milisecond` ë‹¨ìœ„ë¡œ ì¸ìë¥¼ ì£¼ë©´, í•´ë‹¹ durationë§ˆë‹¤ ê³„ì† ì‹¤í–‰ë˜ë©´ì„œ ë©ì–´ë¦¬ ë‹¨ìœ„ë¡œ recordingí•œë‹¤.

```javascript
const startRecording = () => {
    const videoRecorder = new MediaRecorder(streamObject);
    videoRecorder.addEventListener('dataavailable', handleVideoData)
    videoRecorder.start(1000);
}

const handleVideoData = (event) => {
    console.log(event.data, 'is showed every seconds')
    // Blob(234710) {size: 234710, type: 'video/x-matroska; codecs=avc1,opus'} // 1ì´ˆ í›„
    // Blob(234710) {size: 234710, type: 'video/x-matroska; codecs=avc1,opus'} // 2ì´ˆ í›„
}
```

## ìƒì„±ëœ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•˜ëŠ”ë²•
```javascript
const handleVideoData = event => {
    const {
        data: videoFile
    } = event;
    const link = document.createElement('a');
    link.href = URL.createObjectURL(videoFile); // (*)
    link.download = 'recorded.webm'; // (**)
    document.body.appendChild(link);
    link.click(); // (***)
}
```

#### (*) `URL.createObjectURL(object)`  
  - ì£¼ì–´ì§„ ê°ì²´ë¥¼ ê°€ë¦¬í‚¤ëŠ” URLì„ DOMStringìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.  
(Objectì˜ ì¢…ë¥˜ : File, Blob, MediaSource ê°ì²´)  
```javascript
const objectURL = URL.createObjectURL(object)
```
#### (**)  
  - `link.download` : ë‹¤ìš´ë¡œë“œí•  ì´ë¦„ ì§€ì •  
  - `webm` : Googleì˜ ì˜¤í”ˆì†ŒìŠ¤ ë™ì˜ìƒ í¬ë§·  
#### (***) `facking click`
  - ì¡°ì‘ëœ í´ë¦­ì„ ì´ìš©í•˜ì—¬ ë§í¬ í´ë¦­ ë° íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ë„ë¡ í•œë‹¤.


## ì—ëŸ¬ ì²˜ë¦¬
ë¹„ë””ì˜¤ë¥¼ ë…¹í™”í•˜ê³  ë‚˜ì„œ recorded.webmìœ¼ë¡œ ì €ì¥í–ˆì„ ë•Œ ì†Œë¦¬ëŠ” ë“¤ë¦¬ì§€ë§Œ í™”ë©´ì´ ë³´ì´ì§€ ì•Šì•˜ë‹¤.  
[ì—¬ê¸°](https://developers.google.com/web/updates/2016/01/mediarecorder)ì—ì„œ ì•Œë ¤ì¤€ëŒ€ë¡œ `MediaRecorder` ìƒì„±ìë¥¼ ì‚¬ìš©í•  ë•Œ `option`ì„ ì‚¬ìš©í•˜ì—¬ `MIMEType`ì„ ì„¤ì •í•´ì£¼ë‹ˆ í•´ê²°ë˜ì—ˆë‹¤.

```javascript
// ê¸°ì¡´ ì½”ë“œ : videoRecorder = new MediaRecorder(streamObject);
var options = {
    mimeType: 'video/webm;codecs=vp9'
};
videoRecorder = new MediaRecorder(streamObject, options);
```
